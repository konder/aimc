# 🎮 MineDojo 键盘控制完整参考

> **快速参考**: 录制和标注时的键盘映射速查表

---

## 📋 **按键布局总览**

```
┌─────────────────────────────────────────────────────┐
│          MineDojo 录制/标注控制                       │
├─────────────────────────────────────────────────────┤
│                                                     │
│  移动:          视角:          功能:                │
│    W(前)          I(上)          F(攻击)            │
│  A S D        J     L         Space(跳)            │
│  (左后右)        K(下)                              │
│                                                     │
│  组合动作:                                          │
│    Q (前进+攻击)        R (前进+跳跃)               │
│    E (向上看+攻击)      T (后退+跳跃)               │
│    G (前进+跳跃+攻击)                               │
│                                                     │
│  标注控制:                                          │
│    N (跳过状态)                                     │
│    Z (撤销标注)                                     │
│    X/ESC (退出)                                     │
│                                                     │
└─────────────────────────────────────────────────────┘
```

---

## 🎯 **基础动作详解**

### **移动控制**
| 按键 | 动作 | MineDojo动作 | 适用场景 |
|------|------|-------------|---------|
| `W` | 前进 | `[1, 0, 0, 12, 12, 0, 0, 0]` | 录制 + 标注 |
| `S` | 后退 | `[2, 0, 0, 12, 12, 0, 0, 0]` | 录制 + 标注 |
| `A` | 左移 | `[0, 1, 0, 12, 12, 0, 0, 0]` | 录制 + 标注 |
| `D` | 右移 | `[0, 2, 0, 12, 12, 0, 0, 0]` | 录制 + 标注 |

### **视角控制**
| 按键 | 动作 | MineDojo动作 | 角度变化 |
|------|------|-------------|---------|
| `I` | 向上看 | `[0, 0, 0, 8, 12, 0, 0, 0]` | -60° |
| `K` | 向下看 | `[0, 0, 0, 16, 12, 0, 0, 0]` | +60° |
| `J` | 向左看 | `[0, 0, 0, 12, 8, 0, 0, 0]` | -60° |
| `L` | 向右看 | `[0, 0, 0, 12, 16, 0, 0, 0]` | +60° |

### **功能动作**
| 按键 | 动作 | MineDojo动作 | 说明 |
|------|------|-------------|------|
| `F` | 攻击/砍树 | `[0, 0, 0, 12, 12, 3, 0, 0]` | 需连续按10-20次 |
| `Space` | 跳跃 | `[0, 0, 1, 12, 12, 0, 0, 0]` | 跨越障碍 |

---

## ⚡ **组合动作（快捷键）**

### **移动+攻击组合**
| 按键 | 动作 | MineDojo动作 | 使用场景 |
|------|------|-------------|---------|
| `Q` | 前进+攻击 | `[1, 0, 0, 12, 12, 3, 0, 0]` | ⭐ 最常用：边走边砍树 |
| `E` | 向上看+攻击 | `[0, 0, 0, 8, 12, 3, 0, 0]` | 砍高处树叶/树干 |

### **移动+跳跃组合**
| 按键 | 动作 | MineDojo动作 | 使用场景 |
|------|------|-------------|---------|
| `R` | 前进+跳跃 | `[1, 0, 1, 12, 12, 0, 0, 0]` | ⭐ 跳过障碍物 |
| `T` | 后退+跳跃 | `[2, 0, 1, 12, 12, 0, 0, 0]` | 后退避让 |

### **全套组合**
| 按键 | 动作 | MineDojo动作 | 使用场景 |
|------|------|-------------|---------|
| `G` | 前进+跳跃+攻击 | `[1, 0, 1, 12, 12, 3, 0, 0]` | 跳起砍高处树干 |

---

## ⚙️ **特殊控制键**

### **标注工具专用**
| 按键 | 功能 | 说明 |
|------|------|------|
| `N` | 跳过当前状态 | 不标注此状态，直接进入下一个 |
| `Z` | 撤销上一个标注 | 回退到上一个状态，重新标注（最多10步）|

### **通用控制**
| 按键 | 功能 | 适用场景 |
|------|------|---------|
| `X` | 完成/退出 | 录制和标注 |
| `ESC` | 紧急退出 | 录制和标注 |

---

## 🌲 **砍树任务标准流程**

### **阶段1: 寻找树木**
```
1. W (前进) - 四处探索
2. I (向上看) - 寻找树冠
3. J/L (左右看) - 扫视周围
```

### **阶段2: 靠近树木**
```
1. W (前进) - 接近树木
2. I/K (上下看) - 对准树干中部
3. A/D (左右移动) - 调整位置
```

### **阶段3: 砍树**
```
1. Q (前进+攻击) - ⭐ 推荐：一边靠近一边砍
2. 或 F (攻击) - 连续按F砍树
3. K (向下看) - 砍树根部分
```

### **阶段4: 获得木头**
```
持续按Q或F直到树木被破坏
检查是否获得木头（奖励>0）
```

---

## 💡 **录制模式使用技巧**

### **录制高质量演示**
1. ✅ **保持流畅**: 不要频繁切换动作
2. ✅ **对准目标**: 十字准心对准树干中部
3. ✅ **持续攻击**: 砍树需要连续按F或Q（约10-20次）
4. ✅ **避免绕圈**: 保持简单直接的路径
5. ✅ **使用组合键**: Q键提升演示效率

---

## 🎯 **标注模式使用技巧**

### **1. 最常用的5个键**
1. **`Q`** (前进+攻击) - ⭐ 最常用，边走边砍
2. **`I`** (向上看) - 寻找树木
3. **`R`** (前进+跳跃) - 跨越障碍
4. **`N`** (跳过) - 不确定的状态直接跳过
5. **`Z`** (撤销) - 标错了可以纠正

### **2. 标注优先级**

| 优先级 | 场景 | 标注策略 |
|--------|------|---------|
| 🔴 **HIGH** | 失败前5-10步 | 100%标注，这些是关键决策 |
| 🟡 **MEDIUM** | 成功episode中段 | 按`N`跳过，节省时间 |
| 🟢 **LOW** | 成功episode开头 | 按`N`跳过，节省时间 |

### **3. 快速标注流程**
```
看到画面 → 判断策略错误 → 按对应快捷键 → 下一个
  ↓
如果不确定 → 按 'N' 跳过 → 下一个
  ↓
如果标错了 → 按 'Z' 撤销 → 重新标注
```

---

## 📊 **典型标注场景示例**

### **场景1: 智能体向下看地面 ❌**
```
Policy Action: [0, 0, 0, 16, 12, 0, 0, 0] >>> Look Down

✅ 你应该标注: I (向上看寻找树)
```

### **场景2: 智能体原地不动 ❌**
```
Policy Action: [0, 0, 0, 12, 12, 0, 0, 0] >>> Idle

✅ 你应该标注: W (前进) 或 Q (前进+攻击)
```

### **场景3: 智能体只前进不攻击 ❌**
```
Policy Action: [1, 0, 0, 12, 12, 0, 0, 0] >>> Forward

✅ 你应该标注: Q (前进+攻击)
```

### **场景4: 智能体遇到障碍物 ❌**
```
Policy Action: [1, 0, 0, 12, 12, 0, 0, 0] >>> Forward

✅ 你应该标注: R (前进+跳跃)
```

### **场景5: 智能体需要跳起砍树 ❌**
```
Policy Action: [1, 0, 0, 12, 12, 3, 0, 0] >>> Forward + Attack

✅ 你应该标注: G (前进+跳跃+攻击)
```

---

## 🎮 **完整键盘布局图**

```
        [I] 上看
         |
    [J]--+--[L]  (左看/右看)
         |
        [K] 下看

[W]       [E] 上看+攻击    [R] 前进+跳跃    [T] 后退+跳跃
 |                                          
[A][S][D]  [Q] 前进+攻击    [G] 前进+跳跃+攻击
(左后右)
         [F] 攻击          [Space] 跳跃

特殊: [N] 跳过  [Z] 撤销  [X/ESC] 完成
```

---

## 📈 **标注效率参考**

| 状态数 | 智能采样 | 预计时间 | 实际标注数 |
|--------|---------|---------|-----------|
| 5000 | ✅ 开启 | 30-40分钟 | ~800-1000 |
| 5000 | ❌ 关闭 | 2-3小时 | ~5000 |
| 10000 | ✅ 开启 | 50-60分钟 | ~1500-2000 |

**智能采样效率提升**: 80%+ 时间节省 ✅

---

## 🎯 **MineDojo动作空间速查**

```python
# MineDojo MultiDiscrete(8) 动作空间
action = [
    forward_back,  # 0: 0=停止, 1=前进, 2=后退
    left_right,    # 1: 0=停止, 1=左移, 2=右移
    jump,          # 2: 0=不跳, 1=跳跃
    pitch,         # 3: 0-24 (12=水平, <12=向上, >12=向下)
    yaw,           # 4: 0-24 (12=正前, <12=向左, >12=向右)
    functional,    # 5: 0=无, 3=攻击 ✅
    craft,         # 6: 0 (砍树任务不需要)
    smelt          # 7: 0 (砍树任务不需要)
]

# 静止状态 (NOOP)
[0, 0, 0, 12, 12, 0, 0, 0]
```

---

## ⚠️ **常见问题 FAQ**

### **Q1: 为什么要标注"前进+跳跃"？**
**A**: 在Minecraft中，跳跃可以：
- 跨越小障碍物（草丛、矮墙）
- 加速移动（跳跃冲刺）
- 到达高处（跳上树根）

DAgger学习过程中，这些场景经常出现，需要正确标注。

### **Q2: 组合键太多记不住怎么办？**
**A**: 只需记住最常用的5个：
1. `Q` - 前进+攻击
2. `I` - 向上看
3. `R` - 前进+跳跃
4. `N` - 跳过
5. `Z` - 撤销

### **Q3: 什么时候用 'G' (前进+跳跃+攻击)？**
**A**: 很少用，主要场景：
- 树木在小山丘上，需要跳起砍
- 树根很高，需要跳起靠近
- **建议**: 不确定时按 `N` 跳过

### **Q4: 录制时可以用N和Z吗？**
**A**: 不可以，`N`（跳过）和`Z`（撤销）仅在标注工具中可用。

---

## 🔧 **自定义按键配置**

如需修改按键映射，编辑配置文件:
```bash
config/keyboard_mapping.yaml
```

然后重新运行录制/标注工具即可生效。

---

## 📚 **相关文档**

### **参考文档**
- [`MINEDOJO_ACTION_REFERENCE.md`](MINEDOJO_ACTION_REFERENCE.md) - 完整动作参考
- [`MINECLIP_REWARD_REFERENCE.md`](MINECLIP_REWARD_REFERENCE.md) - MineCLIP奖励设计

### **使用指南**
- [`RECORDING_CONTROLS.md`](../guides/RECORDING_CONTROLS.md) - 录制控制说明
- [`DAGGER_QUICK_START.md`](../guides/DAGGER_QUICK_START.md) - DAgger完整流程
- [`LABEL_STATES_GUIDE.md`](../guides/LABEL_STATES_GUIDE.md) - 标注工具详解

---

## 💾 **打印提示**

**建议**: 可以打印此页面放在手边，录制和标注时随时查阅！ 📄

---

**祝录制和标注顺利！** 🚀

记住：不确定的状态直接按 `N` 跳过，不影响训练效果。
