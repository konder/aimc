# VPTæ¨¡å‹å‚è€ƒæŒ‡å—

## ğŸ“¦ VPTæä¾›çš„æ¨¡å‹æ–‡ä»¶

æ ¹æ®[OpenAI VPTä»“åº“](https://github.com/openai/Video-Pre-Training/)ï¼ŒVPTæä¾›äº†ä»¥ä¸‹å‡ ç§é¢„è®­ç»ƒæ¨¡å‹ï¼š

### 1. Foundation Model (åŸºç¡€æ¨¡å‹)
**æ–‡ä»¶**: `foundation-model-*.weights` (~880MB)

**è®­ç»ƒæ•°æ®**ï¼š
- 70,000å°æ—¶æœªæ ‡æ³¨çš„Minecraftæ¸¸æˆè§†é¢‘
- å®Œå…¨æ— ç›‘ç£çš„å­¦ä¹ 

**ç‰¹ç‚¹**ï¼š
- âœ… æœ€å¤§è§„æ¨¡çš„é¢„è®­ç»ƒ
- âœ… å­¦ä¹ åˆ°äº†é€šç”¨çš„Minecraftæ“ä½œæŠ€èƒ½
- âœ… æ²¡æœ‰é’ˆå¯¹ç‰¹å®šä»»åŠ¡ä¼˜åŒ–
- âŒ ç›´æ¥ä½¿ç”¨æ•ˆæœå¯èƒ½ä¸å¦‚å¾®è°ƒç‰ˆæœ¬

**é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦æœ€é€šç”¨çš„é¢„è®­ç»ƒæ¨¡å‹
- è‡ªå·±æœ‰å¤§é‡ç‰¹å®šä»»åŠ¡æ•°æ®è¿›è¡Œå¾®è°ƒ
- ç ”ç©¶Minecraftçš„é€šç”¨è¡¨ç¤ºå­¦ä¹ 

### 2. RL from Early Game (æ—©æœŸæ¸¸æˆRL) â­ **æ¨è**
**æ–‡ä»¶**: `rl-from-early-game-2x.weights` (~948MB)

**è®­ç»ƒæ•°æ®**ï¼š
- Foundation modelä½œä¸ºåŸºç¡€
- åœ¨æ—©æœŸæ¸¸æˆæ•°æ®ä¸Šè¿›è¡ŒRLå¾®è°ƒ
- 2å€æ•°æ®è§„æ¨¡ (2x)

**ç‰¹ç‚¹**ï¼š
- âœ… åœ¨FoundationåŸºç¡€ä¸Šè¿›ä¸€æ­¥ä¼˜åŒ–
- âœ… æ›´é€‚åˆæ—©æœŸæ¸¸æˆä»»åŠ¡ï¼ˆå¦‚é‡‡é›†æœ¨æã€æŒ–çŸ¿ç­‰ï¼‰
- âœ… æ€§èƒ½æ¯”Foundationæ›´å¥½
- âœ… **æœ€å¸¸ç”¨çš„ç‰ˆæœ¬**

**é€‚ç”¨åœºæ™¯**ï¼š
- æ—©æœŸæ¸¸æˆä»»åŠ¡ï¼ˆé‡‡é›†ã€å»ºé€ ã€æ¢ç´¢ï¼‰
- éœ€è¦å¹³è¡¡é€šç”¨æ€§å’Œä»»åŠ¡æ€§èƒ½
- **ä½ çš„harvest_1_logä»»åŠ¡** âœ…

### 3. RL from House (å»ºé€ æˆ¿å±‹RL)
**æ–‡ä»¶**: `rl-from-house-*.weights` (~880MB)

**è®­ç»ƒæ•°æ®**ï¼š
- Foundation modelä½œä¸ºåŸºç¡€
- åœ¨å»ºé€ æˆ¿å±‹ä»»åŠ¡ä¸Šè¿›è¡ŒRLå¾®è°ƒ

**ç‰¹ç‚¹**ï¼š
- âœ… é’ˆå¯¹å»ºé€ ä»»åŠ¡ä¼˜åŒ–
- âŒ å¯¹é‡‡é›†ä»»åŠ¡å¯èƒ½ä¸å¦‚early-gameç‰ˆæœ¬

**é€‚ç”¨åœºæ™¯**ï¼š
- å»ºé€ æˆ¿å±‹ä»»åŠ¡
- BASALT BuildVillageHouseä»»åŠ¡

### 4. Behavioral Cloning Models (è¡Œä¸ºå…‹éš†æ¨¡å‹)
**æ–‡ä»¶**: å„ç§BCæ¨¡å‹

**è®­ç»ƒæ•°æ®**ï¼š
- ä½¿ç”¨IDM (Inverse Dynamics Model) æ ‡æ³¨çš„æ•°æ®
- çº¯è¡Œä¸ºå…‹éš†è®­ç»ƒ

**ç‰¹ç‚¹**ï¼š
- âŒ æ€§èƒ½é€šå¸¸ä¸å¦‚RLå¾®è°ƒç‰ˆæœ¬
- âœ… è®­ç»ƒæ›´ç®€å•å¿«é€Ÿ

**é€‚ç”¨åœºæ™¯**ï¼š
- ç ”ç©¶BC vs RLçš„å·®å¼‚
- å¿«é€ŸåŸå‹éªŒè¯

---

## ğŸ¯ ä½ å½“å‰ä½¿ç”¨çš„æ¨¡å‹

```bash
æ¨¡å‹: rl-from-early-game-2x.weights
å¤§å°: 948 MB
ç±»å‹: Foundation + Early Game RL (2x data)
```

### âœ… è¿™æ˜¯æ­£ç¡®çš„é€‰æ‹©ï¼

**åŸå› **ï¼š
1. **ä»»åŠ¡åŒ¹é…** - harvest_1_logæ˜¯å…¸å‹çš„æ—©æœŸæ¸¸æˆä»»åŠ¡
2. **æ€§èƒ½æœ€ä¼˜** - æ¯”Foundationæ•ˆæœæ›´å¥½
3. **ä½¿ç”¨æœ€å¹¿** - VPTè®ºæ–‡ä¸»è¦ç»“æœéƒ½åŸºäºè¿™ä¸ªç‰ˆæœ¬
4. **æ–‡æ¡£é½å…¨** - æœ€å¤šäººä½¿ç”¨å’Œæµ‹è¯•

---

## ğŸ“Š æ¨¡å‹æ€§èƒ½å¯¹æ¯”

| æ¨¡å‹ | è®­ç»ƒæ•°æ® | å‚æ•°é‡ | Early Gameä»»åŠ¡ | å»ºé€ ä»»åŠ¡ | é€šç”¨æ€§ |
|------|---------|--------|---------------|---------|-------|
| **Foundation** | 70Kå°æ—¶è§†é¢‘ | 230M | è‰¯å¥½ | è‰¯å¥½ | æœ€é«˜ â­â­â­ |
| **Early-Game-2x** â­ | Foundation + RL | 230M | **ä¼˜ç§€** â­â­â­ | è‰¯å¥½ | é«˜ â­â­ |
| **House** | Foundation + RL | 230M | ä¸€èˆ¬ | **ä¼˜ç§€** â­â­â­ | ä¸­ â­ |
| **BC Models** | IDMæ ‡æ³¨ | 230M | ä¸­ç­‰ | ä¸­ç­‰ | ä¸­ â­ |

---

## ğŸ” å¦‚ä½•é€‰æ‹©æ¨¡å‹

### å†³ç­–æ ‘

```
ä½ çš„ä»»åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ
â”œâ”€ æ—©æœŸæ¸¸æˆï¼ˆé‡‡é›†ã€æ¢ç´¢ã€ç®€å•å»ºé€ ï¼‰
â”‚  â””â”€ âœ… ä½¿ç”¨ rl-from-early-game-2x.weights
â”‚
â”œâ”€ å»ºé€ å¤æ‚å»ºç­‘
â”‚  â””â”€ ä½¿ç”¨ rl-from-house-*.weights
â”‚
â”œâ”€ éœ€è¦æœ€é€šç”¨çš„æ¨¡å‹ï¼ˆè‡ªå·±å¤§é‡å¾®è°ƒï¼‰
â”‚  â””â”€ ä½¿ç”¨ foundation-model-*.weights
â”‚
â””â”€ å¿«é€Ÿå®éªŒéªŒè¯
   â””â”€ ä½¿ç”¨ BC models
```

### é’ˆå¯¹ä½ çš„harvest_1_logä»»åŠ¡

**æ¨è**: `rl-from-early-game-2x.weights` âœ… (ä½ å·²ç»åœ¨ä½¿ç”¨)

**ç†ç”±**ï¼š
1. **ä»»åŠ¡ç±»å‹**: ç æ ‘æ˜¯å…¸å‹çš„æ—©æœŸæ¸¸æˆä»»åŠ¡
2. **æœ€ä½³æ€§èƒ½**: è¯¥æ¨¡å‹åœ¨ç±»ä¼¼ä»»åŠ¡ä¸Šè¡¨ç°æœ€å¥½
3. **è®­ç»ƒæ•°æ®**: åŒ…å«å¤§é‡é‡‡é›†æœ¨æçš„ç¤ºèŒƒ
4. **ç¤¾åŒºéªŒè¯**: å¤§éƒ¨åˆ†ç”¨æˆ·åœ¨æ—©æœŸä»»åŠ¡ä¸Šä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬

---

## ğŸ“¥ ä¸‹è½½å…¶ä»–æ¨¡å‹ï¼ˆå¯é€‰ï¼‰

å¦‚æœæƒ³å°è¯•å…¶ä»–æ¨¡å‹ï¼š

### Foundation Model
```bash
# ä¸‹è½½foundation model
cd data/pretrained/vpt/
wget https://openaipublic.blob.core.windows.net/minecraft-rl/models/foundation-model-1x.weights
```

### House Building Model
```bash
# ä¸‹è½½house building model
cd data/pretrained/vpt/
wget https://openaipublic.blob.core.windows.net/minecraft-rl/models/rl-from-house-1x.weights
```

---

## ğŸ”¬ æ¨¡å‹æ–‡ä»¶ç»“æ„

### .weights æ–‡ä»¶
**å†…å®¹**ï¼š
- 230Må‚æ•°çš„ç¥ç»ç½‘ç»œæƒé‡
- ImpalaCNN + Transformer layers
- å®Œæ•´çš„ç­–ç•¥ç½‘ç»œï¼ˆä¸å«action headsï¼‰

**å¤§å°**: ~880-950 MB

### .model æ–‡ä»¶
**å†…å®¹**ï¼š
- æ¨¡å‹æ¶æ„é…ç½®ï¼ˆJSONï¼‰
- è¶…å‚æ•°è®¾ç½®
- è®­ç»ƒé…ç½®ä¿¡æ¯

**å¤§å°**: ~4-5 KB

---

## âš™ï¸ åˆ‡æ¢æ¨¡å‹ï¼ˆå¦‚æœéœ€è¦ï¼‰

### ä¿®æ”¹è®­ç»ƒè„šæœ¬

```python
# src/training/vpt/train_bc_vpt.py
parser.add_argument('--vpt-weights', type=str, 
                   default="data/pretrained/vpt/rl-from-early-game-2x.weights",  # ä¿®æ”¹è¿™é‡Œ
                   help='VPTé¢„è®­ç»ƒæƒé‡è·¯å¾„')
```

### ä¿®æ”¹æµ‹è¯•è„šæœ¬

```bash
# scripts/vpt_quick_test.sh
VPT_WEIGHTS="data/pretrained/vpt/rl-from-early-game-2x.weights"  # ä¿®æ”¹è¿™é‡Œ
```

### å‘½ä»¤è¡ŒæŒ‡å®š

```bash
# è®­ç»ƒæ—¶æŒ‡å®šå…¶ä»–æ¨¡å‹
python src/training/vpt/train_bc_vpt.py \
  --vpt-weights data/pretrained/vpt/foundation-model-1x.weights \
  --expert-dir data/tasks/harvest_1_log/expert_demos \
  --epochs 20
```

---

## ğŸ“Š é¢„æœŸæ•ˆæœå¯¹æ¯”

### åœ¨harvest_1_logä»»åŠ¡ä¸Šçš„é¢„æœŸè¡¨ç°

| æ¨¡å‹ | BCè®­ç»ƒåæˆåŠŸç‡ | è®­ç»ƒæ”¶æ•›é€Ÿåº¦ | æ³›åŒ–èƒ½åŠ› |
|------|---------------|-------------|---------|
| **Early-Game-2x** â­ | **30-60%** | å¿« | å¥½ |
| Foundation | 20-40% | ä¸­ | æœ€å¥½ |
| House | 15-30% | æ…¢ | ä¸€èˆ¬ |
| Random Init | <1% | éå¸¸æ…¢ | å·® |

**è¯´æ˜**ï¼š
- Early-Game-2xåœ¨é‡‡é›†ä»»åŠ¡ä¸Šè¡¨ç°æœ€å¥½
- Foundationæ›´é€šç”¨ä½†åœ¨ç‰¹å®šä»»åŠ¡ä¸Šç•¥é€Š
- Houseæ¨¡å‹ä¸é€‚åˆé‡‡é›†ä»»åŠ¡

---

## ğŸ“ VPTè®ºæ–‡ä¸­çš„ä½¿ç”¨

æ ¹æ®[VPTè®ºæ–‡](https://arxiv.org/abs/2206.11795)ï¼š

### ä¸»è¦å®éªŒä½¿ç”¨çš„æ¨¡å‹
1. **Foundation model** - ç”¨äºè¯æ˜æ— ç›‘ç£é¢„è®­ç»ƒçš„æœ‰æ•ˆæ€§
2. **RL from early game** - ç”¨äºå¤§éƒ¨åˆ†ä¸‹æ¸¸ä»»åŠ¡è¯„ä¼°
3. **RL from house** - ç‰¹å®šç”¨äºå»ºé€ ä»»åŠ¡

### è®ºæ–‡ç»“è®º
- RLå¾®è°ƒç‰ˆæœ¬æ€§èƒ½ >> Foundation >> éšæœºåˆå§‹åŒ–
- Early-gameç‰ˆæœ¬åœ¨é‡‡é›†ç±»ä»»åŠ¡ä¸Šè¡¨ç°æœ€å¥½
- é¢„è®­ç»ƒå¯ä»¥å‡å°‘90%+çš„æ ‡æ³¨æ•°æ®éœ€æ±‚

---

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### å¯¹äºharvest_1_logä»»åŠ¡

1. **ç»§ç»­ä½¿ç”¨** `rl-from-early-game-2x.weights` âœ…
   - è¿™æ˜¯æœ€ä¼˜é€‰æ‹©
   - å·²ç»è¿‡éªŒè¯
   - æ€§èƒ½æœ€å¥½

2. **å¦‚æœæ•ˆæœä¸ç†æƒ³**ï¼ŒæŒ‰ä¼˜å…ˆçº§å°è¯•ï¼š
   ```
   ç¬¬1æ­¥: å¢åŠ ä¸“å®¶æ•°æ®ï¼ˆ50 â†’ 100 episodesï¼‰
   ç¬¬2æ­¥: è°ƒæ•´è®­ç»ƒè¶…å‚æ•°ï¼ˆlearning rate, epochsï¼‰
   ç¬¬3æ­¥: å°è¯• foundation-modelï¼ˆæ›´é€šç”¨ï¼‰
   ç¬¬4æ­¥: ä½¿ç”¨DAggerè¿­ä»£ä¼˜åŒ–
   ```

3. **ä¸æ¨è**ï¼š
   - âŒ åˆ‡æ¢åˆ°houseæ¨¡å‹ï¼ˆä¸é€‚åˆé‡‡é›†ä»»åŠ¡ï¼‰
   - âŒ ä½¿ç”¨BC-onlyæ¨¡å‹ï¼ˆæ€§èƒ½è¾ƒå·®ï¼‰
   - âŒ éšæœºåˆå§‹åŒ–ï¼ˆæ•ˆæœæå·®ï¼‰

---

## ğŸ“ˆ æ¨¡å‹æ¼”è¿›å†å²

```
Phase 1: Inverse Dynamics Model (IDM)
  â†“
  è®­ç»ƒIDMæ¥é¢„æµ‹åŠ¨ä½œï¼ˆä»è§†é¢‘ï¼‰
  
Phase 2: Foundation Model
  â†“
  ä½¿ç”¨IDMæ ‡æ³¨70Kå°æ—¶è§†é¢‘
  â†“
  è¡Œä¸ºå…‹éš†è®­ç»ƒFoundation Model
  
Phase 3: RL Finetuning
  â†“
  åœ¨ç‰¹å®šä»»åŠ¡ä¸ŠRLå¾®è°ƒ
  â†“
  rl-from-early-game-2x (ä½ åœ¨ç”¨çš„) â­
  rl-from-house
```

---

## ğŸ”— å‚è€ƒèµ„æº

- **VPTè®ºæ–‡**: [https://arxiv.org/abs/2206.11795](https://arxiv.org/abs/2206.11795)
- **VPTä»“åº“**: [https://github.com/openai/Video-Pre-Training](https://github.com/openai/Video-Pre-Training)
- **æ¨¡å‹ä¸‹è½½**: [https://openaipublic.blob.core.windows.net/minecraft-rl/models/](https://openaipublic.blob.core.windows.net/minecraft-rl/models/)
- **MineRLç¯å¢ƒ**: [https://github.com/minerllabs/minerl](https://github.com/minerllabs/minerl)

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæœ‰2xç‰ˆæœ¬ï¼Ÿ
**A**: 2xè¡¨ç¤ºä½¿ç”¨äº†2å€çš„RLè®­ç»ƒæ•°æ®ï¼Œæ€§èƒ½æ›´å¥½ã€‚

### Q2: å¯ä»¥æ··ç”¨ä¸åŒæ¨¡å‹å—ï¼Ÿ
**A**: ä¸å»ºè®®ã€‚é€‰å®šä¸€ä¸ªæ¨¡å‹åï¼Œå®Œæˆæ•´ä¸ªè®­ç»ƒæµç¨‹ã€‚

### Q3: Foundation vs Early-Gameå¦‚ä½•é€‰æ‹©ï¼Ÿ
**A**: 
- æ—©æœŸä»»åŠ¡ï¼ˆé‡‡é›†ã€æ¢ç´¢ï¼‰â†’ Early-Game âœ…
- éœ€è¦æœ€é€šç”¨ â†’ Foundation
- å»ºé€ ä»»åŠ¡ â†’ House

### Q4: æ¨¡å‹æ–‡ä»¶å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ
**A**: 
- å•ä¸ªæƒé‡æ–‡ä»¶~1GBï¼Œè¿™æ˜¯å¿…éœ€çš„
- å¯ä»¥åˆ é™¤ä¸ç”¨çš„æ¨¡å‹èŠ‚çœç©ºé—´
- å‹ç¼©å­˜å‚¨ï¼ˆä½†ä½¿ç”¨æ—¶éœ€è¦è§£å‹ï¼‰

### Q5: å¦‚ä½•éªŒè¯æ¨¡å‹ä¸‹è½½æ­£ç¡®ï¼Ÿ
```bash
# æ£€æŸ¥æ–‡ä»¶å¤§å°
ls -lh data/pretrained/vpt/rl-from-early-game-2x.weights
# åº”è¯¥çº¦ 948M

# éªŒè¯å¯ä»¥åŠ è½½
python test_vpt_env.py
# åº”è¯¥æ˜¾ç¤º: âœ“ VPTæƒé‡åŠ è½½æˆåŠŸ
```

---

## âœ… æ€»ç»“

### ä½ çš„é…ç½®ï¼ˆå®Œç¾ï¼‰

```yaml
ä»»åŠ¡: harvest_1_log (ç æ ‘)
æ¨¡å‹: rl-from-early-game-2x.weights  âœ…
çŠ¶æ€: å·²ä¸‹è½½ï¼Œå·²éªŒè¯
å»ºè®®: æ— éœ€æ›´æ”¹ï¼Œç»§ç»­è®­ç»ƒ
```

### å…³é”®è¦ç‚¹

1. âœ… **ä½ ä½¿ç”¨çš„æ¨¡å‹æ˜¯æ­£ç¡®çš„**
   - rl-from-early-game-2xæ˜¯harvestä»»åŠ¡çš„æœ€ä½³é€‰æ‹©
   
2. âœ… **æ— éœ€ä¸‹è½½å…¶ä»–æ¨¡å‹**
   - é™¤éç‰¹å®šå®éªŒéœ€æ±‚
   
3. âœ… **æ¨¡å‹å·²éªŒè¯é€šè¿‡**
   - Missing=0, Unexpected=0
   - 230Må‚æ•°æ­£ç¡®åŠ è½½

4. ğŸš€ **å¯ä»¥å¼€å§‹è®­ç»ƒäº†**
   - æ¨¡å‹é€‰æ‹©æ­£ç¡®
   - ç¯å¢ƒé…ç½®å®Œæˆ
   - è„šæœ¬å‡†å¤‡å°±ç»ª

---

**å»ºè®®**: ä½¿ç”¨å½“å‰çš„ `rl-from-early-game-2x.weights` å®Œæˆè®­ç»ƒï¼Œæ ¹æ®æ•ˆæœå†³å®šæ˜¯å¦éœ€è¦å°è¯•å…¶ä»–æ¨¡å‹ã€‚å¤§æ¦‚ç‡ä¸éœ€è¦ã€‚

