# fast_reset 参数使用指南

> **功能**: 控制环境reset模式，平衡速度与数据多样性

---

## 🎯 **两种Reset模式**

| 模式 | 参数 | Reset时间 | 数据多样性 | 适用场景 |
|------|------|----------|-----------|---------|
| **完整模式** | `--no-fast-reset` | 5-10秒 | 高 ✅ | **训练数据收集（推荐）** |
| **快速模式** | `--fast-reset` | 1-2秒 | 低 ❌ | 调试/测试 |

---

## 📊 **详细对比**

### **完整模式（`--no-fast-reset`，默认）** ✅

```bash
python tools/record_manual_chopping.py --no-fast-reset
# 或者不加参数（默认就是完整模式）
python tools/record_manual_chopping.py
```

**行为**:
```
round_0: 生成世界A（seed=随机），新树，位置(100, 64, 200)
  → 完成任务，reset...（5-10秒）

round_1: 生成世界B（seed=随机），新树，位置(245, 68, 150) ✅
  → 完成任务，reset...（5-10秒）

round_2: 生成世界C（seed=随机），新树，位置(180, 65, 300) ✅
```

**特点**:
- ✅ 每次reset重新生成全新世界
- ✅ 树木、地形、出生位置都不同
- ✅ 数据多样性最高
- ⚠️ Reset慢（5-10秒）

**适用于**:
- ✅ **训练数据收集**（最重要）
- ✅ 需要高质量、多样化的数据
- ✅ 避免模型过拟合同一场景

---

### **快速模式（`--fast-reset`）** ⚡

```bash
python tools/record_manual_chopping.py --fast-reset
```

**行为**:
```
round_0: 生成世界A，新树，位置(100, 64, 200)
  → 完成任务，reset...（1-2秒）

round_1: 仍然是世界A，树已被砍，位置(100, 64, 200) ❌
  → 完成任务，reset...（1-2秒）

round_2: 仍然是世界A，树已被砍，位置(100, 64, 200) ❌
```

**特点**:
- ✅ Reset快速（1-2秒）
- ❌ 重用同一个世界
- ❌ 树木被砍后不会恢复
- ❌ 数据多样性低

**适用于**:
- ⚠️ 调试脚本（快速迭代）
- ⚠️ 测试功能
- ❌ **不适合训练数据收集**

---

## 🚀 **使用示例**

### **示例1: 收集训练数据（推荐）**

```bash
# 默认使用完整模式（数据多样性高）
python tools/record_manual_chopping.py --max-rounds 10

# 或者显式指定
python tools/record_manual_chopping.py --no-fast-reset --max-rounds 10

# 输出:
================================================================================
MineCLIP 砍树序列录制工具（多回合录制）
================================================================================

基础目录: data/expert_demos
回合范围: round_0 ~ round_9
每回合最大帧数: 1000
Reset模式: 完整模式(重新生成世界)
  ⚠️  完整模式reset较慢(5-10秒)，但数据多样性高
```

---

### **示例2: 快速调试**

```bash
# 使用快速模式（仅用于调试）
python tools/record_manual_chopping.py --fast-reset --max-rounds 3

# 输出:
Reset模式: 快速模式(重用世界)

# Reset只需1-2秒，适合快速测试功能
```

---

### **示例3: 结合其他参数**

```bash
# 完整模式 + 自定义参数
python tools/record_manual_chopping.py \
    --no-fast-reset \
    --max-rounds 20 \
    --max-frames 2000 \
    --camera-delta 2 \
    --base-dir data/my_demos

# 快速模式 + 调试
python tools/record_manual_chopping.py \
    --fast-reset \
    --max-rounds 3 \
    --max-frames 500
```

---

## ⚙️ **参数说明**

```bash
--fast-reset
  使用快速重置模式
  - 重用同一个世界
  - Reset快（1-2秒）
  - 数据多样性低
  - 适合调试

--no-fast-reset (默认)
  使用完整重置模式
  - 重新生成世界
  - Reset慢（5-10秒）
  - 数据多样性高
  - 适合训练数据
```

---

## 💡 **时间成本分析**

### **完整模式时间估算**

```
假设录制10个round:
  每个round录制时间: 约60秒（取决于你的速度）
  每次reset时间: 约7秒
  
总时间 = 10 × (60 + 7) = 670秒 ≈ 11分钟

其中reset时间: 10 × 7 = 70秒 ≈ 1分钟

Reset时间占比: 70 / 670 = 10.4%
```

**结论**: Reset时间占比很小（约10%），**完全可以接受** ✅

---

### **快速模式时间估算**

```
假设录制10个round:
  每个round录制时间: 约60秒
  每次reset时间: 约1.5秒
  
总时间 = 10 × (60 + 1.5) = 615秒 ≈ 10分钟

节省时间: 670 - 615 = 55秒 ≈ 1分钟
```

**结论**: 只节省1分钟，但数据多样性大大降低 ❌

---

## 📈 **数据多样性对比**

### **完整模式（10个round）**

```
round_0: 世界A，地形1，树木布局1
round_1: 世界B，地形2，树木布局2
round_2: 世界C，地形3，树木布局3
round_3: 世界D，地形4，树木布局4
round_4: 世界E，地形5，树木布局5
round_5: 世界F，地形6，树木布局6
round_6: 世界G，地形7，树木布局7
round_7: 世界H，地形8，树木布局8
round_8: 世界I，地形9，树木布局9
round_9: 世界J，地形10，树木布局10

数据多样性: 10种不同场景 ✅
训练效果: 泛化能力强 ✅
```

---

### **快速模式（10个round）**

```
round_0: 世界A，地形1，树木布局1
round_1: 世界A，地形1，树木布局1（树已被砍）
round_2: 世界A，地形1，树木布局1（树已被砍）
round_3: 世界A，地形1，树木布局1（树已被砍）
round_4: 世界A，地形1，树木布局1（树已被砍）
round_5: 世界A，地形1，树木布局1（树已被砍）
round_6: 世界A，地形1，树木布局1（树已被砍）
round_7: 世界A，地形1，树木布局1（树已被砍）
round_8: 世界A，地形1，树木布局1（树已被砍）
round_9: 世界A，地形1，树木布局1（树已被砍）

数据多样性: 1种场景 ❌
训练效果: 过拟合单一场景 ❌
```

---

## ✅ **推荐配置**

### **训练数据收集（强烈推荐）**

```bash
python tools/record_manual_chopping.py --no-fast-reset --max-rounds 10
# 或者省略 --no-fast-reset（默认）
python tools/record_manual_chopping.py --max-rounds 10
```

**原因**:
- ✅ 数据多样性至关重要
- ✅ 多等几秒完全值得
- ✅ 避免模型过拟合

---

### **快速调试（仅限调试）**

```bash
python tools/record_manual_chopping.py --fast-reset --max-rounds 2
```

**原因**:
- ✅ 快速验证功能
- ✅ 节省调试时间
- ⚠️ 仅用于功能测试

---

## 🎯 **常见问题**

### **Q1: 为什么默认是完整模式？**

**A**: 因为：
1. 数据多样性对训练最重要
2. Reset时间占比小（约10%）
3. 多等几秒换取高质量数据完全值得

---

### **Q2: 什么时候用快速模式？**

**A**: 仅在以下情况：
- 调试脚本功能
- 测试控制是否正常
- 快速验证某个功能

**绝不用于**: 收集训练数据 ❌

---

### **Q3: 能混合使用吗？**

**A**: 可以，但不推荐。建议：
- 训练数据: 全部用完整模式
- 调试: 全部用快速模式

---

### **Q4: 完整模式为什么慢？**

**A**: 因为要：
1. 重新生成Minecraft世界（地形、树木、生物等）
2. 重新初始化游戏状态
3. 重新计算光照、物理等

但这些操作确保每次都是全新世界 ✅

---

## 📚 **相关文档**

- [`FAST_RESET_FIX.md`](../issues/FAST_RESET_FIX.md) - fast_reset参数修复说明
- [`MULTI_ROUND_RECORDING_CORRECT.md`](MULTI_ROUND_RECORDING_CORRECT.md) - 多回合录制指南

---

**最后更新**: 2025-10-21  
**默认模式**: 完整模式（`--no-fast-reset`）  
**推荐**: 训练数据收集请使用默认的完整模式 ✅

